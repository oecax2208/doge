"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[67076],{57288:function(e,t,n){n.d(t,{k:function(){return a}});var s=n(92809),o=n(75222),i=JSON.parse('{"container":{"elementType":"div"},"text":{"elementType":"span"},"image":{"elementType":"img","attrs":{"src":{"type":"dynamic","content":{"referenceType":"attr","id":"url"}}},"selfClosing":true},"textinput":{"elementType":"input","attrs":{"type":{"type":"static","content":"text"}},"selfClosing":true},"passwordinput":{"elementType":"input","attrs":{"type":{"type":"static","content":"password"}},"selfClosing":true},"checkbox":{"elementType":"input","attrs":{"type":{"type":"static","content":"checkbox"}},"selfClosing":true},"radiobutton":{"elementType":"input","attrs":{"type":{"type":"static","content":"radio"}},"selfClosing":true},"textarea":{"elementType":"textarea"},"link":{"elementType":"a","attrs":{"href":{"type":"dynamic","content":{"referenceType":"attr","id":"url"}}}},"navlink":{"elementType":"a"},"button":{"elementType":"button"},"form":{"elementType":"form","attrs":{"method":{"type":"dynamic","content":{"referenceType":"attr","id":"type"}},"action":{"type":"dynamic","content":{"referenceType":"attr","id":"url"}}}},"dropdown":{"elementType":"select","children":[{"type":"repeat","content":{"node":{"type":"element","content":{"type":"option","name":"option","children":[{"type":"dynamic","content":{"referenceType":"local","id":"item"}}]}},"dataSource":{"type":"dynamic","content":{"referenceType":"attr","id":"options"}},"meta":{"useIndex":true}}}]},"video":{"elementType":"video"},"audio":{"elementType":"audio"},"icon":{"elementType":"svg"},"path":{"elementType":"path"},"separator":{"elementType":"hr"},"linebreak":{"elementType":"br"}}');function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const a=(e,t="stage")=>{if(e.primitiveType===o.sO.COMPONENT)return null;const{semanticType:n,primitiveType:s}=e,r=n||s;let a=i;"stage"===t&&(a=d(d({},a),l));const c=a[r];return{elementType:(null===c||void 0===c?void 0:c.elementType)||r,attrs:d(d({},null===c||void 0===c?void 0:c.attrs),null===e||void 0===e?void 0:e.attrs),styles:d(d({},null===c||void 0===c?void 0:c.style),e.styles)}},l={button:{elementType:"span"},link:{elementType:"span"},navlink:{elementType:"span"},textarea:{elementType:"textarea",attrs:{readonly:{type:"static",content:"true"}},selfClosing:!0},textinput:{elementType:"input",attrs:{type:{type:"static",content:"text"},readonly:{type:"static",content:"true"}}},radiobutton:{elementType:"input",attrs:{type:{type:"static",content:"radio"}}},checkbox:{elementType:"input",attrs:{type:{type:"static",content:"checkbox"}}}}},67076:function(e,t,n){n.d(t,{o:function(){return U}});var s,o,i,r,d,a,l,c,p,y,u,h,g,m,S,f,v,b=n(73202),I=n(92809),T=n(30773),j=n(49899),w=n(76883),M=n(49403),k=n(89099),N=n(246),O=n(88439),L=n(27726),D=n(16815),C=n(93096),F=n.n(C),x=n(57288),E=n(72307),R=n.n(E),P=n(56924);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,I.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let U=(s=(0,w.f3)("projectDoc"),o=(0,w.f3)("projectUIState"),i=(0,w.f3)("nodeStyleManagmentFlow"),r=(0,w.f3)("componentStyleManagementFlow"),d=(0,w.f3)("fontsInProjectFlow"),a=(0,w.f3)("projectClassManagementFlow"),l=(0,w.f3)("elementRefProvider"),c=(0,w.f3)("tailwindService"),p=class{constructor(){(0,I.Z)(this,"nodeStyleMap",{}),(0,I.Z)(this,"fontsListMap",{}),(0,I.Z)(this,"styleRootNode",null),(0,I.Z)(this,"rootHead",null),(0,I.Z)(this,"renderingMode","stage"),(0,I.Z)(this,"rootNode",null),(0,I.Z)(this,"nodeIdsWithStates",null),(0,I.Z)(this,"isInlinePreview",!1),(0,I.Z)(this,"unsubs",[]),(0,I.Z)(this,"tailwindSubs",[]),(0,b.Z)(this,"projectDoc",y,this),(0,b.Z)(this,"projectUIState",u,this),(0,b.Z)(this,"nodeStyleManagmentFlow",h,this),(0,b.Z)(this,"componentStyleManagementFlow",g,this),(0,b.Z)(this,"fontsInProjectFlow",m,this),(0,b.Z)(this,"projectClassManagementFlow",S,this),(0,b.Z)(this,"elementRefProvider",f,this),(0,b.Z)(this,"tailwindService",v,this),(0,I.Z)(this,"resetTailwindSubs",(()=>{this.tailwindSubs.forEach((e=>e())),this.tailwindSubs=[]})),this.nodeStyleMap.root={}}async init(e){var t;if(this.styleRootNode=e.styleRootNode,this.rootHead=e.rootHead,this.renderingMode=e.renderingMode,this.rootNode=e.rootNode,this.isInlinePreview=e.isInlinePreview,this.setDefaultStyles=F()(this.setDefaultStyles,250),this.subscribeForStyleChanges(),this.subscribeForInteractionStateChange(),this.subscribeForDesignLanguageChanges(),this.setDefaultStyles(),this.subscribeForFontsChange(),this.subscribeForTokensAndNodesUsage(),this.subscribeForKybSpacePressed(),this.subscribeForBgTokenChange(),this.subscribeForClassChanges(),this.subscribeForBreakpointChange(),this.subscribeForDevStylesChange(),this.subscribeForMediaQueryUpdates(),this.subForExperimentalFeatureChanges(),null!==(t=this.projectDoc.settings.experimentalFeatures)&&void 0!==t&&t.tailwindCSS&&this.subscribeForTailwindChanges(),this.rootHead){const e=this.projectDoc.fonts.byId,t=document.createDocumentFragment();Object.values(e||{}).forEach((e=>{if((Object.keys(e.usedInNodes||{}).length>0||Object.keys((null===e||void 0===e?void 0:e.usedInTokens)||{}).length>0||"custom"===e.type)&&e.path&&"system"!==e.type){const n=this.createLinkTag(e.path);this.fontsListMap[e.name]=n,t.append(n)}})),this.rootHead.append(t),this.addQuillCustomFontStyles(e)}this.computeRootStyles()}computeRootStyles(){this.addQuillStyles(),this.addRootBackground(),this.addDevStyles()}addQuillStyles(){var e;if(!this.styleRootNode)return;this.nodeStyleMap.root.quillStyles&&(this.nodeStyleMap.root.quillStyles.remove(),delete this.nodeStyleMap.root.quillStyles);const t=P.Lx.map((e=>`.ql-font-${e.replace(/\s+/g,"-").toLowerCase()} { font-family: "${e}"; }`)),n=document.createElement("style");n.innerHTML=`\n      .ql-container { font-size: inherit !important }\n      .ql-editor { padding: 0; font-family: inherit !important; }\n       strong { font-weight: bolder; }\n       ${t.join("\n")}`,this.nodeStyleMap.root.quillStyles=n,this.styleRootNode.appendChild(n),null===(e=this.rootHead)||void 0===e||e.append(n)}addQuillCustomFontStyles(e){var t;if(!this.styleRootNode)return;this.nodeStyleMap.root.quillFontStyles&&(this.nodeStyleMap.root.quillFontStyles.remove(),delete this.nodeStyleMap.root.quillFontStyles);const n=document.createElement("style");Object.values(e).forEach((e=>{const t=e.name.replace(/\s+/g,"-").toLowerCase();n.innerHTML=`${n.innerHTML}\n        .ql-font-${t} { font-family: "${e.name}"; }\n      `})),this.nodeStyleMap.root.quillFontStyles=n,this.styleRootNode.appendChild(n),null===(t=this.rootHead)||void 0===t||t.append(n)}async generateTailwindStyles(){if(!this.rootNode)return;const e=await this.tailwindService.getStyleSheet(this.rootNode.innerHTML);e&&this.appendTailwindStyles(e)}addRootBackground(){var e;if(!this.styleRootNode||this.projectUIState.userInteractions.inPreviewMode)return;this.nodeStyleMap.root.rootNodeBg&&(this.nodeStyleMap.root.rootNodeBg.remove(),delete this.nodeStyleMap.root.rootNodeBg);const t=(null===(e=this.projectDoc.designLanguage.getTokenWithRole("background-color"))||void 0===e?void 0:e.value)||"white",n=document.createElement("style"),{componentId:s}=this.projectUIState.selection;if(s&&this.projectDoc.components.byId[s]){var o;const e=this.nodeStyleManagmentFlow.getCurrentStyleValueByKeyForNode((null===(o=this.projectDoc.components.byId[s])||void 0===o?void 0:o.rootNodeId)||"",["backgroundColor","backgroundImage"]);(e.backgroundColor||e.backgroundImage)&&"transparent"!==e.backgroundColor||(n.innerHTML="body > div> *  {\n          border-color: #999999;\n          border-width: 1px;\n          border-style: dashed;\n        }")}else n.innerHTML=`body > div> *  {\n        background-color: ${t};\n      }`;this.nodeStyleMap.root.rootNodeBg=n,this.styleRootNode.appendChild(n)}addDevStyles(){var e;const t=this.projectUIState.devMode.devStyles;if(!this.styleRootNode||!Object.keys(t).length)return;this.nodeStyleMap.root.devStyles&&(this.nodeStyleMap.root.devStyles.remove(),delete this.nodeStyleMap.root.devStyles);const n=Object.values(t).join(""),s=document.createElement("style");s.innerHTML=n,this.nodeStyleMap.root.devStyles=s,this.styleRootNode.appendChild(s),null===(e=this.rootHead)||void 0===e||e.append(s)}subForExperimentalFeatureChanges(){const e=(0,j.Ys)(this.projectDoc,["settings","settings/"],((e,t)=>{t.forEach((t=>{var n,s,o,i,r,d;const{value:a,old:l,op:c,pathArray:p}=t;if(!("replace"!==c||"settings"!==p[0]||p.length>1)&&(null===a||void 0===a||null===(n=a.experimentalFeatures)||void 0===n?void 0:n.tailwindCSS)!==(null===l||void 0===l||null===(s=l.experimentalFeatures)||void 0===s?void 0:s.tailwindCSS)){if(null!==(o=e.settings)&&void 0!==o&&null!==(i=o.experimentalFeatures)&&void 0!==i&&i.tailwindCSS)return this.generateTailwindStyles(),void this.subscribeForTailwindChanges();null===(r=this.nodeStyleMap.root["tailwind-style"])||void 0===r||r.remove(),null===(d=this.nodeStyleMap.root)||void 0===d||delete d["tailwind-style"],this.resetTailwindSubs()}}))}),"UIDLStyleSheetManagetSubExpFeatures");this.unsubs.push((()=>e.dispose()))}subscribeForDevStylesChange(){const e=(0,j.Ys)(this.projectUIState,["devMode/devStyles","devMode/devStyles/*"],(()=>{this.addDevStyles()}),"DevStyleChange");this.unsubs.push((()=>e.dispose()))}subscribeForBreakpointChange(){const e=(0,j.Ys)(this.projectUIState,["stage/matchedBreakpoint"],(()=>{this.addRootBackground()}),"UIDLStyleSheetManager10");this.unsubs.push((()=>e.dispose()))}subscribeForKybSpacePressed(){const e=(0,j.Ys)(this.projectUIState,["userInteractions/pressedKeys/space"],((e,t)=>{if(this.projectUIState.drag.draggedEntity)return;const{op:n}=t[0];"add"!==n?"remove"===n&&this.nodeStyleMap.root.cursor&&this.nodeStyleMap.root.cursor.remove():this.appendCursorStyle()}),"UIDLStyleSheetManager1");this.unsubs.push((()=>e.dispose()))}subscribeForFontsChange(){const e=(0,j.Ys)(this.projectDoc,["fonts/byId/*"],((e,t)=>{t.forEach((e=>{const{op:t,value:n,pathArray:s,old:o}=e;if("add"===t&&3===s.length&&"fonts"===s[0]){const{name:e,path:t,type:s}=n;if("system"===s||!t)return;this.appendLinkTag(e,t)}if("remove"===t&&3===s.length&&"fonts"===s[0]){const{name:e}=o;this.removeFontFromHead(e)}})),this.addQuillCustomFontStyles(e.fonts.byId)}),"UIDLStyleSheetManager2");this.unsubs.push((()=>e.dispose()))}subscribeForStyleChanges(){this.projectUIState.userPreferences.layoutStructureVisible&&this.appendLayoutStyleNode();const e=(0,j.Ys)(this.projectDoc,["nodes/byId/*/styles","nodes/byId/*/styles/*","nodes/byId/*/styles/*/disabled","nodes/byId/*/referencedStyles","nodes/byId/*/referencedStyles/*","nodes/byId/*/referencedStyles/*/content/styles","nodes/byId/*/referencedStyles/*/content/styles/*","nodes/byId/*/referencedStyles/*/content/styles/*/disabled"],((e,t)=>{t.forEach((t=>{var n;const{pathArray:s,op:o,value:i,old:r}=t,{componentId:d}=this.projectUIState.selection,a=(null===(n=this.projectDoc.components.byId[d||""])||void 0===n?void 0:n.rootNodeId)||"";if("nodes"!==s[0])return;const l=s[2],c=e.nodes.getSlotAndCompInstanceIdForNodeById(l).compInstanceId||"root";if(l===a&&this.addRootBackground(),"styles"!==s[3])if("referencedStyles"!==s[3]||"styles"!==s[6])if("referencedStyles"!==s[3]||5!==s.length){if("referencedStyles"===s[3]&&5===s.length&&("project-referenced"===(null===i||void 0===i?void 0:i.content.mapType)||"project-referenced"===(null===r||void 0===r?void 0:r.content.mapType))){var p;const t=null===(p=this.rootNode)||void 0===p?void 0:p.querySelector(`[data-node-id="${s[2]}"]`),n=e.classes.byId[s[4]];if("add"===o&&(n.linkedTextStyles&&Object.keys(n.linkedTextStyles).forEach((n=>{const s=e.designLanguage.textStyleSetsById[n];null===t||void 0===t||t.classList.add(s.identifier)})),null===t||void 0===t||t.classList.add(n.identifier)),"remove"===o){var y;const t=null===(y=this.rootNode)||void 0===y?void 0:y.querySelector(`[data-node-id="${s[2]}"]`),n=e.classes.byId[s[4]];n&&(null===t||void 0===t||t.classList.remove(n.identifier))}}if("referencedStyles"===s[3]&&"replace"===o){if(!this.rootNode)return;const t=this.rootNode.querySelector(`[data-node-id="${s[2]}"]`);Object.values(r||{}).forEach((n=>{if("project-referenced"===n.content.mapType){const s=e.classes.byId[n.content.referenceId];s&&(null===t||void 0===t||t.classList.remove(s.identifier))}if("design-language-referenced"===n.content.mapType){const s=n.content.referenceId;if(!e.designLanguage.textStyleSetsById[s])return;this.removeTextStyleFromNode(t,e)}})),Object.values(i||{}).forEach((n=>{if("project-referenced"===n.content.mapType){const s=e.classes.byId[n.content.referenceId];s.linkedTextStyles&&Object.keys(s.linkedTextStyles).forEach((n=>{const s=e.designLanguage.textStyleSetsById[n];this.removeTextStyleFromNode(t,e),null===t||void 0===t||t.classList.add(s.identifier)})),null===t||void 0===t||t.classList.add(s.identifier)}}));const n=Object.values(i||{}).find((e=>"design-language-referenced"===e.content.mapType));if(n){const s=n.content.referenceId,o=e.designLanguage.textStyleSetsById[s];if(!o)return;this.removeTextStyleFromNode(t,e),null===t||void 0===t||t.classList.add(o.identifier)}this.appendStyleForNodeId(l,c)}}else{if("inlined"===(null===i||void 0===i?void 0:i.content.mapType)||"inlined"===(null===r||void 0===r?void 0:r.content.mapType))return void this.appendStyleForNodeId(l,c);if("add"===o&&"design-language-referenced"===(null===i||void 0===i?void 0:i.content.mapType)){const t=i.content.referenceId,n=e.designLanguage.textStyleSetsById[t];if(!n||!this.rootNode)return;const o=this.rootNode.querySelector(`[data-node-id="${s[2]}"]`);this.removeTextStyleFromNode(o,e),null===o||void 0===o||o.classList.add(n.identifier)}if("remove"===o&&"design-language-referenced"===(null===r||void 0===r?void 0:r.content.mapType)){const t=r.content.referenceId;if(!e.designLanguage.textStyleSetsById[t]||!this.rootNode)return;const n=this.rootNode.querySelector(`[data-node-id="${s[2]}"]`);this.removeTextStyleFromNode(n,e)}if("project-referenced"===(null===i||void 0===i?void 0:i.content.mapType)||"project-referenced"===(null===r||void 0===r?void 0:r.content.mapType)){var u;const t=null===(u=this.rootNode)||void 0===u?void 0:u.querySelector(`[data-node-id="${s[2]}"]`),n=e.classes.byId[s[4]];if("add"===o&&(null!==n&&void 0!==n&&n.linkedTextStyles&&Object.keys(n.linkedTextStyles).forEach((n=>{const s=e.designLanguage.textStyleSetsById[n];null===t||void 0===t||t.classList.add(s.identifier)})),null===t||void 0===t||t.classList.add(n.identifier)),"remove"===o){var h;const t=null===(h=this.rootNode)||void 0===h?void 0:h.querySelector(`[data-node-id="${s[2]}"]`),n=e.classes.byId[s[4]];n&&(null===t||void 0===t||t.classList.remove(n.identifier))}}}else this.appendStyleForNodeId(l,c);else this.appendStyleForNodeId(l,c)}))}),"UIDLStyleSheetManager3"),t=(0,j.Ys)(this.projectUIState,["userPreferences/layoutStructureVisible"],((e,t)=>{const{op:n}=t[0];"add"!==n?"remove"===n&&this.nodeStyleMap.root.layout&&this.nodeStyleMap.root.layout.remove():this.appendLayoutStyleNode()}),"UIDLStyleSheetManager4");this.unsubs.push((()=>e.dispose()),(()=>t.dispose()))}subscribeForTokensAndNodesUsage(){const e=(0,j.Ys)(this.projectDoc,["fonts/byId/*/usedInTokens/*","fonts/byId/*/usedInNodes/*"],((e,t)=>{t.forEach((e=>{const{op:t,pathArray:n}=e;if("remove"===t&&"fonts"===n[0]&&5===n.length){const e=this.projectDoc.fonts.byId[n[2]];if(!e)return;const{usedInNodes:t={},usedInTokens:s={}}=e;0===Object.keys(t).length&&0===Object.keys(s).length&&this.removeFontFromHead(e.name)}if("add"===t&&"fonts"===n[0]&&5===n.length){const e=this.projectDoc.fonts.byId[n[2]];e&&e.path&&"system"!==e.type&&this.appendLinkTag(e.name,e.path)}}))}),"UIDLStyleSheetManager5");this.unsubs.push((()=>e.dispose()))}subscribeForDesignLanguageChanges(){const e=(0,j.Ys)(this.projectDoc,["designLanguage/categoriesById/*","designLanguage/categoriesById/**","designLanguage/tokensById/*","designLanguage/tokensById/**","designLanguage/textStyleSetsById/*","designLanguage/textStyleSetsById/**","designLanguage/categoriesById/*"],((e,t)=>{this.setDefaultStyles(),this.tailwindService.generateTailwindClassOptions(),t.forEach((t=>{const{op:n,pathArray:s}=t;if("replace"===n&&"tokensById"===s[1]&&"name"===s[3]){const t=s[2],n=e.designLanguage.tokensById[t];if(!n)return;Object.keys(n.usedInNodes).forEach((e=>{this.appendStyleForNodeId(e)}))}if("replace"===n&&"categoriesById"===s[1]&&"name"===s[3]){const t=s[2];e.designLanguage.getTokensByCategoryId(t).forEach((e=>{Object.keys(e.usedInNodes).forEach((e=>{this.appendStyleForNodeId(e)}))}))}if("tokensById"===s[1]&&"value"===s[3]){if("background-color"!==e.designLanguage.tokensById[s[2]].role)return;this.computeRootStyles()}}))}),"UIDLStyleSheetManager6");this.unsubs.push((()=>e.dispose()))}subscribeForTailwindChanges(){const e=(0,j.Ys)(this.projectUIState,["tailwind/selected","tailwind/selected/*"],((e,t)=>{t.forEach((t=>{const{pathArray:n,op:s}=t;if("tailwind"!==n[0])return;const o=e.tailwind.selected;if((null===o||void 0===o||!o.nodeId)&&"remove"!==s)return;if((null===o||void 0===o||!o.nodeId)&&"remove"===s&&null!==t&&void 0!==t&&t.old){const{nodeId:e}=t.old,n=this.projectDoc.nodes.byId[e],s=this.elementRefProvider.getDomNodeElementRefByCompInstance(e);if(!n||!s)throw new Error(`Node ${e} is missing from the project`);return null===s||void 0===s||s.removeAttribute("class"),void(null===s||void 0===s||s.classList.add(...(0,k.ux)({renderingMode:this.renderingMode,tailwind:this.projectDoc.tailwindCSS.getTailwindClassesForNode(n.id),referencedStyles:null===n||void 0===n?void 0:n.referencedStyles,textStyleTokens:this.projectDoc.designLanguage.textStyleSetsById,cssClassesList:this.projectDoc.classes.byId,nodeId:null===n||void 0===n?void 0:n.id})))}const{nodeId:i,classNames:r}=o,d=this.projectDoc.nodes.byId[i],a=this.elementRefProvider.getDomNodeElementRefByCompInstance(i);if(!d||!a)throw new Error(`Node ${i} is missing from the project`);const l=(0,k.ux)({renderingMode:this.renderingMode,tailwind:this.projectDoc.tailwindCSS.getTailwindClassesForNode(d.id),referencedStyles:null===d||void 0===d?void 0:d.referencedStyles,textStyleTokens:this.projectDoc.designLanguage.textStyleSetsById,cssClassesList:this.projectDoc.classes.byId,nodeId:null===d||void 0===d?void 0:d.id});null===a||void 0===a||a.removeAttribute("class"),null===r&&(null===a||void 0===a||a.classList.add(...l)),r&&"string"===typeof r&&(null===a||void 0===a||a.classList.add(...l,r)),r&&"object"===typeof r&&(null===a||void 0===a||a.classList.add(...l,...r)),"add"!==t.op&&"replace"!==t.op||this.generateTailwindStyles()}))}),"UIDLStyleSheetManager7"),t=(0,j.Ys)(this.projectDoc,["tailwindCSS/byId/*/**","tailwindCSS/byId/*/*"],((e,t)=>{t.forEach((e=>{const{pathArray:t,op:s,value:o,old:i}=e;if("tailwindCSS"!==t[0]||4!==t.length)return;let r=this.elementRefProvider.getDomNodeElementRefByCompInstance(t[2]);r?n(r,s,i,o):setTimeout((()=>{r=this.elementRefProvider.getDomNodeElementRefByCompInstance(t[2]),r&&n(r,s,i,o)}),50)}))}),"UIDLStyleSheetManager8"),n=(e,t,n,s)=>{if("add"===t){if(!(0,k.a6)(s))return;e.classList.add(s),this.generateTailwindStyles()}"remove"===t&&e&&n&&e.classList.remove(n)};this.tailwindSubs.push((()=>t.dispose()),(()=>e.dispose()))}subscribeForClassChanges(){const e=(0,j.Ys)(this.projectDoc,["classes/byId/**"],((e,t)=>{t.forEach((t=>{const{pathArray:n,op:s}=t;if("classes"===n[0]&&n.length>4&&"conditions"===n[3]){const t=e.classes.byId[n[2]];if(!t)return;const o=n[4];"add"===s&&"element-state"===t.conditions[o].type&&Object.keys(t.usedInNodes||{}).forEach((e=>{this.appendStyleForNodeId(e)}))}})),this.appendCustomStyleSheet("project-classes",this.projectClassManagementFlow.getResolvedStylesForRendering(this.renderingMode))}),"UIDLStyleManagerClassSubscriber"),t=(0,j.Ys)(this.projectDoc,["classes/byId/*","classes/byId/*/usedInNodes/*"],((e,t)=>{t.forEach((t=>{const{pathArray:n,op:s}=t;if("classes"===n[0]&&"remove"===s&&5===n.length&&"usedInNodes"===n[3]){var o;const t=null===(o=this.rootNode)||void 0===o?void 0:o.querySelector(`[data-node-id="${n[4]}"]`);null===t||void 0===t||t.classList.forEach((n=>{if(e.designLanguage.getTextStyleByIdentifier(n))return;e.classes.getAll().find((e=>e.identifier===n))||null===t||void 0===t||t.classList.remove(n)}))}}))}),"UIDLStyleManagerClassSubscriber"),n=(0,j.Ys)(this.projectDoc,["classes/byId/*/disabledInNodes/*"],((e,t)=>{t.forEach((t=>{var n,s;const{pathArray:o,op:i}=t;if("classes"!==o[0]||o.length<4||"disabledInNodes"!==o[3])return;const r=null===(n=this.rootNode)||void 0===n?void 0:n.querySelector(`[data-node-id="${o[4]}"]`),d=null===(s=e.classes.byId[o[2]])||void 0===s?void 0:s.identifier;d&&("add"===i&&(null===r||void 0===r||r.classList.remove(d)),"remove"===i&&(null===r||void 0===r||r.classList.add(d)))}))}),"UIDLStyleManagerClassDisableSubscriber"),s=(0,j.Ys)(this.projectDoc,["classes/byId/*/linkedTextStyles/*"],((e,t)=>{t.forEach((t=>{const{pathArray:n,op:s}=t;if("classes"!==n[0]||"linkedTextStyles"!==n[3])return;const o=e.classes.byId[n[2]].usedInNodes,i=e.designLanguage.textStyleSetsById[n[4]];Object.keys(o).forEach((t=>{if(!i||!this.rootNode)return;const n=this.rootNode.querySelector(`[data-node-id="${t}"]`);"add"===s||"replace"===s?(this.removeTextStyleFromNode(n,e),null===n||void 0===n||n.classList.add(i.identifier)):this.removeTextStyleFromNode(n,e)}))}))}),"UIDLStyleManagerClassSubscriber");this.unsubs.push((()=>e.dispose()),(()=>s.dispose()),(()=>t.dispose()),(()=>n.dispose()))}subscribeForBgTokenChange(){const e=(0,j.Ys)(this.projectDoc,["designLanguage/tokensById/*/role"],(()=>{this.addRootBackground()}),"UIDLStyleSheetManager7");this.unsubs.push((()=>e.dispose()))}subscribeForMediaQueryUpdates(){const e=(0,j.Ys)(this.projectDoc,["mediaQueryBreakpoints/byId/*/maxWidth"],(async(e,t)=>{t.forEach((t=>{const{pathArray:n}=t;if("mediaQueryBreakpoints"!==n[0]||"maxWidth"!==n[3])return;const s=this.projectUIState.selection.componentId;if(!s)return;const o=e.getRootNodeIdForPageOrComponent(s);o&&e.nodes.bfs(o,(t=>{const n=e.nodes.getSlotAndCompInstanceIdForNodeById(t.id).compInstanceId||"root";this.appendStyleForNodeId(t.id,n)}))}))}),"UIDLStyleSheetManagerMQs");this.unsubs.push((()=>e.dispose()))}subscribeForInteractionStateChange(){const e=(e,t)=>{if(!this.nodeIdsWithStates)return;let n=0;for(;n<this.nodeIdsWithStates.length;){const s=this.nodeIdsWithStates[n];let o=this.projectDoc.nodes.getNodeSubtreeIds(s);t||(o=o.filter((e=>e!==s)));Object.keys(e.selection.nodes).some((e=>o.includes(e)))?n+=1:(this.appendStyleForNodeId(s),this.nodeIdsWithStates.splice(n,1))}},t=(0,j.Ys)(this.projectUIState,["stage/interactionState"],(t=>{if(e(t,!1),t.stage.interactionState.state){const e=this.projectDoc.classes.byId[t.stage.interactionState.classId||""],n=e?Object.keys(e.usedInNodes):Object.keys(t.selection.nodes);return this.nodeIdsWithStates=[...this.nodeIdsWithStates||[],...n],void n.forEach((e=>this.appendStyleForNodeId(e)))}this.nodeIdsWithStates}),"UIDLStyleSheetManager8"),n=(0,j.Ys)(this.projectUIState,["selection/nodes/*"],((t,n)=>{n.forEach((e=>{const{pathArray:t,op:n}=e;if("remove"===n&&3===t.length&&"selection"===t[0]){const e=this.projectDoc.nodes.byId[t[2]];if(!e)return;const n=this.projectDoc.tailwindCSS.getTailwindClassesForNode(t[2]);if(Object.keys(n||{}).length>0){const t=this.elementRefProvider.getDomNodeElementRefByCompInstance(e.id);null===t||void 0===t||t.removeAttribute("class"),null===t||void 0===t||t.classList.add(...(0,k.ux)({renderingMode:this.renderingMode,tailwind:n,referencedStyles:e.referencedStyles,textStyleTokens:this.projectDoc.designLanguage.textStyleSetsById,cssClassesList:this.projectDoc.classes.byId,nodeId:e.id}))}}})),!t.stage.interactionState.state&&this.nodeIdsWithStates&&e(t,!0)}),"UIDLStyleSheetManager9");this.unsubs.push((()=>t.dispose()),(()=>n.dispose()))}detach(){this.unsubs.forEach((e=>e())),this.unsubs=[],this.resetTailwindSubs()}extractTextStylesFromTokens(e){if(!e||0===Object.keys(e||{}).length)return"";const t=Object.values(e).sort(((e,t)=>e.position-t.position)).reduce(((e,t)=>(e[t.identifier]=(0,O.$e)(Object.keys(t.content||{}).reduce(((e,n)=>{var s;return e[n]=null===(s=t.content[n])||void 0===s?void 0:s.content,e}),{}),"stage"),e)),{});return(0,O.f7)(t)}setDefaultStyles(){if(!this.styleRootNode)return;const e=(0,M.w0)(this.projectDoc.designLanguage);this.appendCustomStyleSheet("reset",(0,L.D)()),this.appendCustomStyleSheet("elements-style",(0,M.Vu)(e,!0)),this.appendCustomStyleSheet("project-style",`${(0,M.lf)(e,"stage"===this.renderingMode)} \n ${this.extractTextStylesFromTokens(this.projectDoc.designLanguage.textStyleSetsById||{})}`),this.appendCustomStyleSheet("design-language",this.getDesignLanguageVariables()),this.appendCustomStyleSheet("project-classes",this.projectClassManagementFlow.getResolvedStylesForRendering(this.renderingMode)),this.appendCustomStyleSheet("utility-classes",(0,M.Uc)())}getDesignLanguageVariables(){const e=this.projectDoc.designLanguage.getTokensAsCustomProperties();return`:root {${Object.keys(e).map((t=>{const{name:n,value:s}=e[t];return`${n}: ${s};`})).join("\n")}}`}appendCursorStyle(){var e;const t=document.createElement("style");return t.innerHTML=k.b7,this.nodeStyleMap.root.cursor=t,null===(e=this.styleRootNode)||void 0===e||e.append(t),t}appendLayoutStyleNode(){var e;const t=document.createElement("style");return t.innerHTML=k.bZ,this.nodeStyleMap.root.layout=t,null===(e=this.styleRootNode)||void 0===e||e.append(t),t}appendCustomStyleSheet(e,t){if(this.styleRootNode)if(this.nodeStyleMap.root[e])this.nodeStyleMap.root[e].innerHTML=t;else{const n=document.createElement("style");n.dataset.reference=e,n.innerHTML=t,this.styleRootNode.append(n),this.nodeStyleMap.root[e]=n}}appendStyleForNodeId(e,t){var n;t=t||"root";const s=this.projectDoc.nodes.byId[e];if(!s||!this.styleRootNode)return;const o=[];s.parentId||o.push(`div[data-node-id='${e}']:not([data-comp-instance-id]) {margin:0 !important;}`);const i="root"!==t?`[data-comp-instance-id='${t}']`:"",r=this.nodeStyleManagmentFlow.getResolvedStyles({nodeId:e,dynamicStyleResult:"variable",replaceAssetIdsWithSrcs:!0,ignoreDisabledNodes:"stage"===this.renderingMode}),d=(null===(n=(0,x.k)(s,this.renderingMode))||void 0===n?void 0:n.elementType)||"",{styles:a,referencedStyles:l}=this.componentStyleManagementFlow.getStylesInheritedFromComponentInstance(e,t),c=this.nodeStyleManagmentFlow.resolveStaticAndDynamicNodes({styles:a,dynamicStyleResult:"variable",replaceAssetIdsWithSrcs:!0,ignoreDisabledNodes:"stage"===this.renderingMode});o.push(`${d}[data-node-id='${e}']${i} {${(0,O.$e)($($({},r),c),this.renderingMode,this.isInlinePreview)}}`),o.push(...this.getMediaQueryStyles(e,l,d,i));const p=this.getUIStatesStyles(s,d);if(p&&("string"===typeof p?o.push(p):o.push(...p)),this.nodeStyleMap[t]||(this.nodeStyleMap[t]={}),this.nodeStyleMap[t][e])this.nodeStyleMap[t][e].innerHTML=o.join("\n");else{const n=document.createElement("style");n.dataset.styleId=e,n.dataset.reference="inlined",n.innerHTML=o.join("\n"),this.nodeStyleMap[t][e]=n,this.styleRootNode.appendChild(n)}}getMediaQueryStyles(e,t,n,s){const o=[];return this.projectDoc.mediaQueryBreakpoints.getNonDefaultActiveMQBreakpointsInOrder().map((e=>e.maxWidth)).sort(((e,t)=>t-e)).forEach((i=>{const r=this.nodeStyleManagmentFlow.getResolvedInlineStyles({nodeId:e,condition:{conditionType:"screen-size",maxWidth:i},dynamicStyleResult:"variable",replaceAssetIdsWithSrcs:!0,ignoreDisabledNodes:"stage"===this.renderingMode}),d=Object.values(t).find((e=>"inlined"===e.content.mapType&&R()(e.content.conditions[0],{conditionType:"screen-size",maxWidth:i}))),a=this.nodeStyleManagmentFlow.resolveStaticAndDynamicNodes({styles:(null===d||void 0===d?void 0:d.content.styles)||{},dynamicStyleResult:"variable",replaceAssetIdsWithSrcs:!0,ignoreDisabledNodes:"stage"===this.renderingMode});o.push(`\n @media(max-width: ${i}px) { ${n}[data-node-id='${e}']${s} { ${(0,O.$e)($($({},r),a),this.renderingMode,this.isInlinePreview)} }}`)})),o}getUIStatesStyles(e,t){const n=e.id;if("preview"===this.renderingMode){return Object.keys(D.F).map((s=>{const o=this.nodeStyleManagmentFlow.getResolvedInlineStyles({nodeId:n,condition:{conditionType:"element-state",content:s},dynamicStyleResult:"variable",replaceAssetIdsWithSrcs:!0,ignoreDisabledNodes:"stage"===this.renderingMode});let i=t;var r;if(Object.keys(o).length)return null!==(r=e.abilities)&&void 0!==r&&r.link&&["visited","link"].includes(s)&&(i="a"),`${i}[data-node-id='${n}']:${s} {${(0,O.$e)(o,this.renderingMode,this.isInlinePreview)}}`})).filter((e=>e))}{const e=this.projectUIState.stage.interactionState,s=e.state;if(!s)return;const o=this.projectDoc.classes.byId[e.classId||""];if((o?Object.keys((null===o||void 0===o?void 0:o.usedInNodes)||{}):Object.keys(this.projectUIState.selection.nodes)).includes(n)){const e=this.nodeStyleManagmentFlow.getResolvedInlineStyles({nodeId:n,condition:{conditionType:"element-state",content:s},dynamicStyleResult:"variable",replaceAssetIdsWithSrcs:!0,ignoreDisabledNodes:"stage"===this.renderingMode}),o=this.projectClassManagementFlow.getResolvedInteractionStateForClasses(this.projectClassManagementFlow.getClassesUsedByNodes([n]));return`${t}[data-node-id='${n}'] {${(0,O.$e)($($({},o),e),this.renderingMode,this.isInlinePreview)}}`}}}appendTailwindStyles(e){var t;const n=this.nodeStyleMap.root["tailwind-style"];if(n)return void(n.innerHTML=e);const s=document.createElement("style");s.dataset.reference="tailwind-style",s.innerHTML=e;const o=this.nodeStyleMap.root["design-language"];o&&this.styleRootNode&&(null===(t=o.parentElement)||void 0===t||t.insertBefore(s,o.previousSibling),this.nodeStyleMap.root["tailwind-style"]=s)}resolveTokenValue(e){var t;const n=null===(t=this.projectDoc.designLanguage.getTokensAsCustomProperties()[e.content.id])||void 0===t?void 0:t.name;return new N.F({content:`var(${n})`})}appendLinkTag(e,t){if(this.fontsListMap[e]||!this.rootHead)return;const n=this.createLinkTag(t);this.rootHead.append(n),this.fontsListMap[e]=n}createLinkTag(e){const t=document.createElement("link");return t.setAttribute("href",e),t.setAttribute("rel","stylesheet"),t}removeFontFromHead(e){this.fontsListMap[e]&&(this.fontsListMap[e].remove(),delete this.fontsListMap[e])}removeStyleForNode(e,t){t=t||"root",this.styleRootNode&&this.nodeStyleMap[t]&&this.nodeStyleMap[t][e]&&(this.nodeStyleMap[t][e].remove(),delete this.nodeStyleMap[t][e])}removeTextStyleFromNode(e,t){null===e||void 0===e||e.classList.forEach((n=>{t.designLanguage.getTextStyleByIdentifier(n)&&(null===e||void 0===e||e.classList.remove(n))}))}},y=(0,T.Z)(p.prototype,"projectDoc",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=(0,T.Z)(p.prototype,"projectUIState",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=(0,T.Z)(p.prototype,"nodeStyleManagmentFlow",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=(0,T.Z)(p.prototype,"componentStyleManagementFlow",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=(0,T.Z)(p.prototype,"fontsInProjectFlow",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=(0,T.Z)(p.prototype,"projectClassManagementFlow",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=(0,T.Z)(p.prototype,"elementRefProvider",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=(0,T.Z)(p.prototype,"tailwindService",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p)},89099:function(e,t,n){n.d(t,{m7:function(){return y},BD:function(){return g},bZ:function(){return b},b7:function(){return I},ux:function(){return T},a6:function(){return j}});var s=n(92809),o=n(67294),i=n(77729),r=n(75222),d=n(68768),a=n(57288),l=n(20510);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const y=e=>{var t,n;const{nodeData:s,instanceId:o,renderingMode:i="stage",slug:d,nodeParentData:l,getAssetSrcFromId:c,textStyleTokens:y={},cssClassesList:h={},devComponents:b={},slotId:I,previewHidden:j=!1,previewSize:w,tailwindClasses:M={}}=e,k=T({renderingMode:i,tailwind:M,referencedStyles:s.referencedStyles,textStyleTokens:y,cssClassesList:h,nodeId:s.id});if(s.primitiveType===r.sO.COMPONENT)return S({nodeData:s,slug:d,renderingMode:i,instanceId:o});if(s.primitiveType===r.sO.SLOT&&w)return m(s,o,w,j,I);if(s.primitiveType===r.sO.DEV_COMPONENT)return f(s,b,o,I);if(s.primitiveType===r.sO.HTML_NODE||s.primitiveType===r.sO.LOTTIE)return v(s,o,k);const N=(0,a.k)(s,i);if(!N)throw new Error(`Requested element is not resolved - ${s.primitiveType}`);const O="svg"===N.elementType||"path"===N.elementType?document.createElementNS("http://www.w3.org/2000/svg",N.elementType):document.createElement(N.elementType);if(I&&Object.assign(O.dataset,{slotId:I,pos:s.pos}),e.isDragged&&O.style.setProperty("opacity","0.5"),s.primitiveType===r.sO.IMAGE&&(O.ondragstart=()=>!1),s.primitiveType===r.sO.TEXTINPUT&&"stage"===i&&(O.onclick=()=>!1),Object.keys(p(p({},null===N||void 0===N?void 0:N.attrs),null===s||void 0===s?void 0:s.attrs)).forEach((e=>{const t=N.attrs[e];"object"===typeof t&&"static"===t.type?O.setAttribute(e,c(String(t.content))):O.setAttribute(e,c(String(s.attrs[e])))})),"root"!==o?Object.assign(O.dataset,{nodeId:s.id,compInstanceId:o,type:s.semanticType||s.primitiveType}):(null===l||void 0===l?void 0:l.primitiveType)===r.sO.ICON?Object.assign(O.dataset,{nodeId:s.id,compInstanceId:l.id,type:s.semanticType||s.primitiveType}):Object.assign(O.dataset,{nodeId:s.id,type:s.semanticType||s.primitiveType}),g(O,s.contentChildren),null!==(t=s.abilities)&&void 0!==t&&t.link&&Object.assign(O.dataset,{ability:"link"}),O.classList.add(...k),null!==s&&void 0!==s&&s.abilities&&null!==(n=s.abilities)&&void 0!==n&&n.link&&"preview"===i){const{type:e,content:t}=s.abilities.link;return u({type:e,content:t,node:O,slug:d})}return O},u=e=>{const{type:t,content:n,slug:s,node:o}=e;switch(t){case i.RZ.URL:{const{url:e,newTab:t}=n,s=h({url:e,newTab:t,node:o});return s.append(o),s}case i.RZ.NAVLINK:{const e=(0,l.zg)(s,n.routeName),t=h({url:e,node:o});return t.append(o),t}case i.RZ.SECTION:{const e=h({url:`#${n.section}`,node:o});return e.append(o),e}default:{const e=document.createElement("a");return e.appendChild(o),e}}},h=e=>{const{url:t,newTab:n,node:s}=e,o=document.createElement("a");return o.style.display="contents",o.style.textDecoration="none",Object.assign(o,p(p({},{href:t}),n&&{target:"_blank"})),Object.assign(o.dataset,{type:"link"}),s.dataset.nodeId&&Object.assign(o.dataset,{nodeId:s.dataset.nodeId}),o},g=(e,t={})=>{Object.keys(t).length&&Object.values(t).forEach((t=>{let n="";if("static"===t.type){if(t.content===d.$m||t.content===`${d.$m}${d.$m}`)return void(e.innerHTML=t.content);n=String(t.content)}const s=document.createTextNode(n);null===e||void 0===e||e.append(s)}))},m=(e,t,n,s,o)=>{const i=document.createElement("div");s?(i.style.width="0px",i.style.height="0px"):(i.style.width=n.width,i.style.height=n.height),i.style.backgroundImage="url('https://play.teleporthq.io/static/svg/slot-preview.svg')",i.style.backgroundSize="cover",i.style.backgroundPosition="center",i.style.backgroundRepeat="no-repeat",i.style.backgroundColor="#D9D9D9";const r={nodeId:e.id,type:e.primitiveType};return o&&(r.slotId=o),"root"!==t&&(r.compInstanceId=t),Object.assign(i.dataset,r),i},S=({nodeData:e,slug:t,renderingMode:n,instanceId:s})=>{var o;const i=document.createElement("div");if(i.style.display="contents",Object.assign(i.dataset,{nodeId:e.id,type:e.semanticType||e.primitiveType,slotId:e.slotId,compInstanceId:s}),null!==e&&void 0!==e&&null!==(o=e.abilities)&&void 0!==o&&o.link&&"preview"===n){const{link:n}=e.abilities;return u({type:n.type,content:n.content,node:i,slug:t})}return i},f=(e,t,n,s)=>{const i=document.createElement("div");if(!e.devComponentPath)return i;if(!t[e.devComponentPath]){const e=document.createElement("span");return e.innerText="Widget not loaded",i.appendChild(e),i}const r=t[e.devComponentPath],d=r.component,a=r.props||{},l=Object.keys(a).reduce(((t,n)=>{const s=e.attrs[n],o="string"===typeof s?s:"static"===(null===s||void 0===s?void 0:s.type)?s.content:null;return t[n]=o||a[n].defaultValue,t}),{}),c=o.createElement(d,p({},l)),y={nodeId:e.id,type:e.semanticType||e.primitiveType};s&&(y.slotId=s),"root"!==n&&(y.compInstanceId=n),Object.assign(i.dataset,y);const u=window.exports.ReactDOM;return u?(u.render(c,i),i):(i.innerHTML="ReactDOM was not exposed from the renderer",i)},v=(e,t,n)=>{const s=document.createElement("div");e.html&&(s.innerHTML=e.html);const o={nodeId:e.id,type:e.primitiveType};return"root"!==t&&(o.compInstanceId=t),Object.keys(e.attrs).forEach((t=>{s.setAttribute(t,String(e.attrs[t]))})),Object.assign(s.dataset,o),s.classList.add(...n),s},b="* {\n  background-color: rgba(255, 255, 255, 0.2) !important;\n  filter: grayscale(1);\n  outline: 1px dashed #1e1e1e !important;\n  outline-offset: -1px !important;\n  color: #262626 !important;\n  background-blend-mode: darken;\n}\n",I=" * {\n  cursor: grab;\n}\n",T=e=>{const{renderingMode:t,tailwind:n,referencedStyles:s,textStyleTokens:o,cssClassesList:i,nodeId:r}=e,d=[];return Object.values(n||{}).forEach((e=>{"preview"!==t?j(e)&&d.push(e):d.push(e)})),Object.values(s||{}).filter((e=>{if("design-language-referenced"===e.content.mapType){const t=o[e.content.referenceId];if(!t)throw new Error("TextStyle is missing from the design token");d.push(t.identifier)}if("project-referenced"===e.content.mapType)return e})).forEach((e=>{var t;const n=i[e.content.referenceId];!n||null!==(t=n.disabledInNodes)&&void 0!==t&&t[r]||(n.linkedTextStyles&&Object.keys(n.linkedTextStyles).forEach((e=>{const t=o[e];d.push(t.identifier)})),d.push(n.identifier))})),d},j=e=>1===e.split(":").length}}]);
